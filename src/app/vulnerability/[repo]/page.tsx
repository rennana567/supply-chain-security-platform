'use client';

import { useState, useEffect, use } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { ThemeToggle } from '@/components/ThemeToggle';
import { loadVulnerabilityData } from '@/lib/data-loader';

interface VulnerabilityData {
  id: string;
  component: string;
  version: string;
  severity: 'high' | 'medium' | 'low';
  cve: string;
  description: string;
  fixVersion: string;
  publishedDate: string;
}

// æ¨¡æ‹Ÿæ•°æ®æ˜ å°„ï¼ˆä½œä¸ºå¤‡ç”¨ï¼‰
const repoVulnerabilityDataMap: Record<string, {
  name: string;
  vulnerabilities: VulnerabilityData[];
  summary: {
    total: number;
    high: number;
    medium: number;
    low: number;
  };
}> = {
  'repo-kafka-python': {
    name: 'Kafka Python',
    vulnerabilities: [
      {
        id: 'CVE-2023-12345',
        component: 'requests',
        version: '2.28.0',
        severity: 'high',
        cve: 'CVE-2023-12345',
        description: 'HTTPè¯·æ±‚å¤´æ³¨å…¥æ¼æ´',
        fixVersion: '2.28.1',
        publishedDate: '2023-01-15'
      },
      {
        id: 'CVE-2023-23456',
        component: 'urllib3',
        version: '1.26.0',
        severity: 'medium',
        cve: 'CVE-2023-23456',
        description: 'URLè§£æå®‰å…¨ç»•è¿‡æ¼æ´',
        fixVersion: '1.26.1',
        publishedDate: '2023-02-20'
      },
      {
        id: 'CVE-2023-34567',
        component: 'cryptography',
        version: '3.4.0',
        severity: 'low',
        cve: 'CVE-2023-34567',
        description: 'å¼±éšæœºæ•°ç”Ÿæˆå™¨',
        fixVersion: '3.4.1',
        publishedDate: '2023-03-10'
      },
      {
        id: 'CVE-2023-45678',
        component: 'Django',
        version: '4.1.0',
        severity: 'high',
        cve: 'CVE-2023-45678',
        description: 'SQLæ³¨å…¥æ¼æ´',
        fixVersion: '4.1.1',
        publishedDate: '2023-04-05'
      },
      {
        id: 'CVE-2023-56789',
        component: 'Vue',
        version: '3.2.0',
        severity: 'medium',
        cve: 'CVE-2023-56789',
        description: 'XSSè·¨ç«™è„šæœ¬æ¼æ´',
        fixVersion: '3.2.1',
        publishedDate: '2023-05-12'
      },
    ],
    summary: { total: 8, high: 2, medium: 3, low: 3 },
  },
  'repo-vue-django-bookshop': {
    name: 'Vue Django BookShop',
    vulnerabilities: [
      {
        id: 'CVE-2023-45678',
        component: 'Django',
        version: '4.1.0',
        severity: 'high',
        cve: 'CVE-2023-45678',
        description: 'SQLæ³¨å…¥æ¼æ´',
        fixVersion: '4.1.1',
        publishedDate: '2023-04-05'
      },
      {
        id: 'CVE-2023-56789',
        component: 'Vue',
        version: '3.2.0',
        severity: 'medium',
        cve: 'CVE-2023-56789',
        description: 'XSSè·¨ç«™è„šæœ¬æ¼æ´',
        fixVersion: '3.2.1',
        publishedDate: '2023-05-12'
      },
    ],
    summary: { total: 5, high: 1, medium: 2, low: 2 },
  },
  'repo-probabilistic-forecasts': {
    name: 'Probabilistic Forecasts Attacks',
    vulnerabilities: [
      {
        id: 'CVE-2023-67890',
        component: 'numpy',
        version: '1.24.0',
        severity: 'medium',
        cve: 'CVE-2023-67890',
        description: 'æ•°ç»„è¶Šç•Œè¯»å–æ¼æ´',
        fixVersion: '1.24.1',
        publishedDate: '2023-06-18'
      },
      {
        id: 'CVE-2023-78901',
        component: 'pandas',
        version: '1.5.0',
        severity: 'low',
        cve: 'CVE-2023-78901',
        description: 'æ•°æ®è§£æå†…å­˜æ³„æ¼',
        fixVersion: '1.5.1',
        publishedDate: '2023-07-22'
      },
      {
        id: 'CVE-2023-89012',
        component: 'tensorflow',
        version: '2.11.0',
        severity: 'high',
        cve: 'CVE-2023-89012',
        description: 'æ¨¡å‹ååºåˆ—åŒ–æ¼æ´',
        fixVersion: '2.11.1',
        publishedDate: '2023-08-30'
      },
      {
        id: 'CVE-2023-90123',
        component: 'matplotlib',
        version: '3.6.0',
        severity: 'medium',
        cve: 'CVE-2023-90123',
        description: 'æ–‡ä»¶è·¯å¾„éå†æ¼æ´',
        fixVersion: '3.6.1',
        publishedDate: '2023-09-14'
      },
      {
        id: 'CVE-2023-91234',
        component: 'torch',
        version: '1.13.0',
        severity: 'high',
        cve: 'CVE-2023-91234',
        description: 'å¼ é‡æ“ä½œå†…å­˜ç ´åæ¼æ´',
        fixVersion: '1.13.1',
        publishedDate: '2023-11-20'
      },
    ],
    summary: { total: 17, high: 4, medium: 9, low: 4 },
  },
  'repo-wumei-smart': {
    name: 'Wumei Smart',
    vulnerabilities: [
      {
        id: 'CVE-2023-89012',
        component: 'flask',
        version: '2.2.0',
        severity: 'high',
        cve: 'CVE-2023-89012',
        description: 'ä¼šè¯å›ºå®šæ”»å‡»æ¼æ´',
        fixVersion: '2.2.1',
        publishedDate: '2023-08-30'
      },
    ],
    summary: { total: 6, high: 1, medium: 2, low: 3 },
  },
  'repo-xiangtian-workbench': {
    name: 'Xiangtian Workbench',
    vulnerabilities: [
      {
        id: 'CVE-2023-90123',
        component: 'tensorflow',
        version: '2.11.0',
        severity: 'high',
        cve: 'CVE-2023-90123',
        description: 'æ¨¡å‹ååºåˆ—åŒ–æ¼æ´',
        fixVersion: '2.11.1',
        publishedDate: '2023-09-14'
      },
      {
        id: 'CVE-2023-91234',
        component: 'matplotlib',
        version: '3.6.0',
        severity: 'medium',
        cve: 'CVE-2023-91234',
        description: 'æ–‡ä»¶è·¯å¾„éå†æ¼æ´',
        fixVersion: '3.6.1',
        publishedDate: '2023-10-05'
      },
    ],
    summary: { total: 10, high: 2, medium: 4, low: 4 },
  },
  'repo-pytorch': {
    name: 'PyTorch',
    vulnerabilities: [
      {
        id: 'CVE-2023-92345',
        component: 'torch',
        version: '1.13.0',
        severity: 'high',
        cve: 'CVE-2023-92345',
        description: 'å¼ é‡æ“ä½œå†…å­˜ç ´åæ¼æ´',
        fixVersion: '1.13.1',
        publishedDate: '2023-11-20'
      },
      {
        id: 'CVE-2023-93456',
        component: 'torchvision',
        version: '0.14.0',
        severity: 'medium',
        cve: 'CVE-2023-93456',
        description: 'å›¾åƒå¤„ç†ç¼“å†²åŒºæº¢å‡º',
        fixVersion: '0.14.1',
        publishedDate: '2023-12-08'
      },
    ],
    summary: { total: 15, high: 4, medium: 6, low: 5 },
  },
  'repo-llama': {
    name: 'Meta Llama',
    vulnerabilities: [
      {
        id: 'CVE-2023-94567',
        component: 'transformers',
        version: '4.25.0',
        severity: 'high',
        cve: 'CVE-2023-94567',
        description: 'æ¨¡å‹åŠ è½½è¿œç¨‹ä»£ç æ‰§è¡Œ',
        fixVersion: '4.25.1',
        publishedDate: '2024-01-12'
      },
    ],
    summary: { total: 8, high: 2, medium: 3, low: 3 },
  },
  'repo-tensorflow': {
    name: 'TensorFlow',
    vulnerabilities: [
      {
        id: 'CVE-2023-95678',
        component: 'tensorflow',
        version: '2.12.0',
        severity: 'high',
        cve: 'CVE-2023-95678',
        description: 'å›¾æ‰§è¡Œæƒé™æå‡æ¼æ´',
        fixVersion: '2.12.1',
        publishedDate: '2024-02-18'
      },
      {
        id: 'CVE-2023-96789',
        component: 'keras',
        version: '2.12.0',
        severity: 'medium',
        cve: 'CVE-2023-96789',
        description: 'å±‚é…ç½®éªŒè¯ç»•è¿‡',
        fixVersion: '2.12.1',
        publishedDate: '2024-03-25'
      },
    ],
    summary: { total: 20, high: 5, medium: 8, low: 7 },
  },
  'repo-deepseek-v3': {
    name: 'DeepSeek V3',
    vulnerabilities: [
      {
        id: 'CVE-2023-97890',
        component: 'react',
        version: '18.2.0',
        severity: 'medium',
        cve: 'CVE-2023-97890',
        description: 'è™šæ‹ŸDOMå†…å­˜æ³„æ¼',
        fixVersion: '18.2.1',
        publishedDate: '2024-04-10'
      },
    ],
    summary: { total: 7, high: 1, medium: 3, low: 3 },
  },
  'repo-mistral-inference': {
    name: 'Mistral Inference',
    vulnerabilities: [
      {
        id: 'CVE-2023-98901',
        component: 'torch',
        version: '2.0.0',
        severity: 'high',
        cve: 'CVE-2023-98901',
        description: 'æ¨¡å‹æ¨ç†å†…å­˜æ³„æ¼',
        fixVersion: '2.0.1',
        publishedDate: '2024-05-15'
      },
    ],
    summary: { total: 9, high: 2, medium: 4, low: 3 },
  },
};

interface Props {
  params: Promise<{
    repo: string;
  }>;
}

export default function VulnerabilityDetailPage({ params }: Props) {
  const router = useRouter();
  const [vulnerabilityData, setVulnerabilityData] = useState<{
    vulnerabilities: VulnerabilityData[];
    summary: {
      total: number;
      high: number;
      medium: number;
      low: number;
    };
  }>({
    vulnerabilities: [],
    summary: { total: 0, high: 0, medium: 0, low: 0 },
  });
  const [searchQuery, setSearchQuery] = useState('');
  const [currentPage, setCurrentPage] = useState(1);
  const [repoName, setRepoName] = useState<string>('');
  const [selectedEcosystem, setSelectedEcosystem] = useState<string>('all');
  const itemsPerPage = 20;

  const resolvedParams = use(params);
  const repo = resolvedParams.repo as string;

  useEffect(() => {
    async function fetchVulnerabilityData() {
      try {
        const data = await loadVulnerabilityData(repo);
        if (data && data.vulnerabilities) {
          // ä½¿ç”¨çœŸå®æ•°æ®ä¸­çš„æ¼æ´ä¿¡æ¯å’Œç»Ÿè®¡ä¿¡æ¯
          const vulnerabilities: VulnerabilityData[] = data.vulnerabilities;

          const summary = {
            total: data.summary.total_vulnerabilities,
            high: data.summary.high,
            medium: data.summary.medium,
            low: data.summary.low
          };

          setVulnerabilityData({
            vulnerabilities,
            summary,
          });

          // è®¾ç½®ä»“åº“åç§°
          const repoNameMap: Record<string, string> = {
            'repo-kafka-python': 'Kafka Python',
            'repo-xiangtian-workbench': 'Xiangtian Workbench',
            'repo-wumei-smart': 'Wumei Smart',
            'repo-probabilistic-forecasts': 'Probabilistic Forecasts Attacks',
            'repo-vue-django-bookshop': 'Vue Django BookShop',
            'repo-pytorch': 'PyTorch',
            'repo-tensorflow': 'TensorFlow',
            'repo-deepseek-v3': 'DeepSeek V3',
            'repo-llama': 'Meta Llama',
            'repo-mistral-inference': 'Mistral Inference'
          };
          setRepoName(repoNameMap[repo] || repo);
        } else {
          // å¦‚æœåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ç©ºæ•°æ®ä½œä¸ºå¤‡ç”¨
          setVulnerabilityData({
            vulnerabilities: [],
            summary: { total: 0, high: 0, medium: 0, low: 0 },
          });
          setRepoName(repo);
        }
      } catch (error) {
        console.error('Error loading vulnerability data:', error);
        // å‡ºé”™æ—¶ä½¿ç”¨ç©ºæ•°æ®
        setVulnerabilityData({
          vulnerabilities: [],
          summary: { total: 0, high: 0, medium: 0, low: 0 },
        });
        setRepoName(repo);
      }
    }

    fetchVulnerabilityData();
  }, [repo]);

  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case 'high':
        return 'bg-red-600/20 text-red-400';
      case 'medium':
        return 'bg-orange-600/20 text-orange-400';
      case 'low':
        return 'bg-yellow-600/20 text-yellow-400';
      default:
        return 'bg-gray-600/20 text-gray-400';
    }
  };

  const getSeverityText = (severity: string) => {
    switch (severity) {
      case 'high':
        return 'é«˜å±';
      case 'medium':
        return 'ä¸­å±';
      case 'low':
        return 'ä½å±';
      default:
        return 'æœªçŸ¥';
    }
  };

  // è·å–æ‰€æœ‰ç”Ÿæ€ç³»ç»Ÿç±»å‹
  const ecosystems = Array.from(new Set(
    vulnerabilityData.vulnerabilities.map(vuln => {
      // æ ¹æ®ç»„ä»¶åæ¨æ–­ç”Ÿæ€ç³»ç»Ÿ
      if (vuln.component.includes('@')) return 'npm';
      if (vuln.component.includes('-') && !vuln.component.includes('.')) return 'pip';
      if (vuln.component.includes('.') && vuln.component.length > 3) return 'maven';
      return 'other';
    })
  ));

  const filteredVulnerabilities = vulnerabilityData.vulnerabilities.filter((vuln) => {
    const matchesSearch = vuln.component.toLowerCase().includes(searchQuery.toLowerCase()) ||
                         vuln.cve.toLowerCase().includes(searchQuery.toLowerCase());

    if (selectedEcosystem === 'all') return matchesSearch;

    // æ ¹æ®ç»„ä»¶åæ¨æ–­ç”Ÿæ€ç³»ç»Ÿ
    let ecosystem = 'other';
    if (vuln.component.includes('@')) ecosystem = 'npm';
    else if (vuln.component.includes('-') && !vuln.component.includes('.')) ecosystem = 'pip';
    else if (vuln.component.includes('.') && vuln.component.length > 3) ecosystem = 'maven';

    return matchesSearch && ecosystem === selectedEcosystem;
  });

  const totalPages = Math.ceil(filteredVulnerabilities.length / itemsPerPage);
  const paginatedVulnerabilities = filteredVulnerabilities.slice(
    (currentPage - 1) * itemsPerPage,
    currentPage * itemsPerPage
  );

  return (
    <div className="min-h-screen bg-[var(--background)] text-[var(--foreground)]">
      {/* Header */}
      <header className="border-b border-[var(--border)] bg-[var(--card)]/50 backdrop-blur-sm">
        <div className="container mx-auto px-6 py-4 flex justify-between items-center">
          <div className="flex items-center gap-4">
            <button
              onClick={() => router.back()}
              className="text-[var(--muted-foreground)] hover:text-[var(--foreground)] transition-colors"
            >
              â† è¿”å›
            </button>
            <button
              onClick={() => router.push('/home')}
              className="text-[var(--primary)] hover:text-[var(--primary)]/80 transition-colors"
            >
              ğŸ  è¿”å›é¦–é¡µ
            </button>
            <div>
              <h1 className="text-2xl font-bold text-gradient">
                æ¼æ´æ£€æµ‹ - {repoName || repoVulnerabilityDataMap[repo]?.name || repo}
              </h1>
              <p className="text-sm text-[var(--muted-foreground)] mt-1">è¯¦ç»†çš„å®‰å…¨æ¼æ´åˆ†æ</p>
            </div>
          </div>
          <div className="flex items-center gap-4">
            <ThemeToggle />
          </div>
        </div>
      </header>

      {/* Main Content */}
      <main className="container mx-auto px-6 py-8">
        {/* Summary Section */}
        <div className="mb-8">
          <div className="bg-[var(--card)] border border-[var(--border)] rounded-lg p-6">
            <h2 className="text-xl font-semibold mb-4">æ¼æ´æ¦‚è§ˆ</h2>
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
              <div className="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                <div className="text-2xl font-bold text-blue-600">{vulnerabilityData.summary.total}</div>
                <div className="text-sm text-[var(--muted-foreground)]">æ¼æ´æ€»æ•°</div>
              </div>
              <div className="text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg">
                <div className="text-2xl font-bold text-red-600">{vulnerabilityData.summary.high}</div>
                <div className="text-sm text-[var(--muted-foreground)]">é«˜å±æ¼æ´</div>
              </div>
              <div className="text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                <div className="text-2xl font-bold text-orange-600">{vulnerabilityData.summary.medium}</div>
                <div className="text-sm text-[var(--muted-foreground)]">ä¸­å±æ¼æ´</div>
              </div>
              <div className="text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                <div className="text-2xl font-bold text-yellow-600">{vulnerabilityData.summary.low}</div>
                <div className="text-sm text-[var(--muted-foreground)]">ä½å±æ¼æ´</div>
              </div>
            </div>
          </div>
        </div>

        {/* Search and Filters */}
        <div className="bg-[var(--card)] border border-[var(--border)] rounded-lg p-6 mb-6">
          <div className="flex flex-col md:flex-row gap-4">
            <div className="flex-1">
              <input
                type="text"
                placeholder="æœç´¢ç»„ä»¶åç§°æˆ–CVE ID..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="w-full px-4 py-2 bg-[var(--input)] border border-[var(--border)] rounded-lg text-[var(--foreground)] placeholder-[var(--muted-foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
              />
            </div>
            <div className="flex gap-2">
              <select
                value={selectedEcosystem}
                onChange={(e) => setSelectedEcosystem(e.target.value)}
                className="px-4 py-2 bg-[var(--input)] border border-[var(--border)] rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
              >
                <option value="all">æ‰€æœ‰ç”Ÿæ€ç³»ç»Ÿ</option>
                {ecosystems.includes('npm') && <option value="npm">npm</option>}
                {ecosystems.includes('pip') && <option value="pip">pip</option>}
                {ecosystems.includes('maven') && <option value="maven">maven</option>}
                {ecosystems.includes('other') && <option value="other">å…¶ä»–</option>}
              </select>
            </div>
          </div>
        </div>

        {/* Vulnerability Details Table */}
        <div className="bg-[var(--card)] border border-[var(--border)] rounded-lg overflow-hidden">
          <div className="p-6 border-b border-[var(--border)]">
            <h2 className="text-xl font-semibold">æ¼æ´è¯¦æƒ…</h2>
            <p className="text-sm text-[var(--muted-foreground)] mt-1">
              é¡¹ç›®ä¸­å‘ç°çš„æ‰€æœ‰å®‰å…¨æ¼æ´åŠå…¶è¯¦ç»†ä¿¡æ¯ ({filteredVulnerabilities.length} ä¸ªæ¼æ´)
            </p>
          </div>

          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-[var(--input)]">
                <tr>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">CVE ID</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">ç»„ä»¶</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">ç‰ˆæœ¬</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">ä¸¥é‡ç¨‹åº¦</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">æè¿°</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">ä¿®å¤ç‰ˆæœ¬</th>
                  <th className="px-4 py-3 text-left text-sm font-semibold text-[var(--muted-foreground)]">å‘å¸ƒæ—¥æœŸ</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-[var(--border)]">
                {paginatedVulnerabilities.map((vuln, index) => (
                  <tr key={index} className="hover:bg-[var(--input)] transition-colors">
                    <td className="px-4 py-3 text-sm font-medium">
                      <a
                        href={`https://nvd.nist.gov/vuln/detail/${vuln.cve}`}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="text-blue-600 hover:text-blue-700 hover:underline"
                      >
                        {vuln.cve}
                      </a>
                    </td>
                    <td className="px-4 py-3 text-sm font-medium">{vuln.component}</td>
                    <td className="px-4 py-3 text-sm text-[var(--muted-foreground)]">{vuln.version}</td>
                    <td className="px-4 py-3 text-sm">
                      <span className={`px-2 py-1 rounded text-xs ${getSeverityColor(vuln.severity)}`}>
                        {getSeverityText(vuln.severity)}
                      </span>
                    </td>
                    <td className="px-4 py-3 text-sm text-[var(--muted-foreground)]">{vuln.description}</td>
                    <td className="px-4 py-3 text-sm">
                      <span className="px-2 py-1 bg-green-600/20 text-green-400 rounded text-xs">
                        {vuln.fixVersion}
                      </span>
                    </td>
                    <td className="px-4 py-3 text-sm text-[var(--muted-foreground)]">{vuln.publishedDate}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          {/* Pagination */}
          {totalPages > 1 && (
            <div className="flex items-center justify-center gap-2 p-4 border-t border-[var(--border)]">
              <button
                onClick={() => setCurrentPage((prev) => Math.max(1, prev - 1))}
                disabled={currentPage === 1}
                className="px-3 py-1 rounded bg-[var(--input)] text-[var(--muted-foreground)] hover:text-[var(--foreground)] disabled:opacity-50 disabled:cursor-not-allowed"
              >
                ä¸Šä¸€é¡µ
              </button>
              {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (
                <button
                  key={page}
                  onClick={() => setCurrentPage(page)}
                  className={`px-3 py-1 rounded ${
                    currentPage === page
                      ? 'bg-[var(--primary)] text-white'
                      : 'bg-[var(--input)] text-[var(--muted-foreground)] hover:text-[var(--foreground)]'
                  }`}
                >
                  {page}
                </button>
              ))}
              <button
                onClick={() => setCurrentPage((prev) => Math.min(totalPages, prev + 1))}
                disabled={currentPage === totalPages}
                className="px-3 py-1 rounded bg-[var(--input)] text-[var(--muted-foreground)] hover:text-[var(--foreground)] disabled:opacity-50 disabled:cursor-not-allowed"
              >
                ä¸‹ä¸€é¡µ
              </button>
            </div>
          )}

          {filteredVulnerabilities.length === 0 && (
            <div className="text-center py-12 text-[var(--muted-foreground)]">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ¼æ´</div>
          )}
        </div>

        {/* Security Analysis */}
        <div className="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="bg-[var(--card)] border border-[var(--border)] rounded-lg p-6">
            <h3 className="text-lg font-semibold mb-3 flex items-center gap-2">
              <span className="text-2xl">ğŸ›¡ï¸</span>
              å®‰å…¨å»ºè®®
            </h3>
            <ul className="text-sm text-[var(--muted-foreground)] space-y-2">
              <li>â€¢ ç«‹å³æ›´æ–°æ‰€æœ‰é«˜å±æ¼æ´çš„ç»„ä»¶ç‰ˆæœ¬</li>
              <li>â€¢ å®šæœŸæ£€æŸ¥ä¾èµ–åŒ…çš„å®‰å…¨æ›´æ–°</li>
              <li>â€¢ å®æ–½å®‰å…¨ç¼–ç è§„èŒƒå’Œä»£ç å®¡æŸ¥</li>
              <li>â€¢ é…ç½®è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æå·¥å…·</li>
            </ul>
          </div>

          <div className="bg-[var(--card)] border border-[var(--border)] rounded-lg p-6">
            <h3 className="text-lg font-semibold mb-3 flex items-center gap-2">
              <span className="text-2xl">ğŸ“Š</span>
              é£é™©åˆ†æ
            </h3>
            <div className="space-y-2">
              <div className="flex justify-between text-sm">
                <span>æ€»ä½“é£é™©ç­‰çº§</span>
                <span className={vulnerabilityData.summary.high > 3 ? 'text-red-600' :
                               vulnerabilityData.summary.high > 1 ? 'text-orange-600' : 'text-green-600'}>
                  {vulnerabilityData.summary.high > 3 ? 'é«˜é£é™©' :
                   vulnerabilityData.summary.high > 1 ? 'ä¸­é£é™©' : 'ä½é£é™©'}
                </span>
              </div>
              <div className="flex justify-between text-sm">
                <span>é«˜å±æ¼æ´å æ¯”</span>
                <span className="text-red-600">
                  {vulnerabilityData.summary.total > 0
                    ? Math.round((vulnerabilityData.summary.high / vulnerabilityData.summary.total) * 100)
                    : 0}%
                </span>
              </div>
              <div className="flex justify-between text-sm">
                <span>ä¸­å±æ¼æ´å æ¯”</span>
                <span className="text-orange-600">
                  {vulnerabilityData.summary.total > 0
                    ? Math.round((vulnerabilityData.summary.medium / vulnerabilityData.summary.total) * 100)
                    : 0}%
                </span>
              </div>
              <div className="flex justify-between text-sm">
                <span>ä½å±æ¼æ´å æ¯”</span>
                <span className="text-yellow-600">
                  {vulnerabilityData.summary.total > 0
                    ? Math.round((vulnerabilityData.summary.low / vulnerabilityData.summary.total) * 100)
                    : 0}%
                </span>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  );
}